# ğŸš€ LeafAuto Web - å¾®ä¿¡æ¶ˆæ¯è‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿ

<div align="center">
  <a href="https://www.gnu.org/licenses/agpl-3.0">
    <img src="https://img.shields.io/badge/License-AGPL_v3-blue?style=for-the-badge&logo=gnu" alt="License: AGPL v3">
  </a>
  <a href="https://github.com/YangShengzhou03/LeafAutoWeb">
    <img src="https://img.shields.io/github/stars/YangShengzhou03/LeafAutoWeb?style=for-the-badge&logo=github" alt="GitHub Stars">
  </a>
  <a href="https://github.com/YangShengzhou03/LeafAutoWeb">
    <img src="https://img.shields.io/github/forks/YangShengzhou03/LeafAutoWeb?style=for-the-badge&logo=github" alt="GitHub Forks">
  </a>
  <a href="https://github.com/YangShengzhou03/LeafAutoWeb/issues">
    <img src="https://img.shields.io/github/issues/YangShengzhou03/LeafAutoWeb?style=for-the-badge&logo=github" alt="GitHub Issues">
  </a>
  <a href="https://github.com/YangShengzhou03/LeafAutoWeb/pulls">
    <img src="https://img.shields.io/github/issues-pr/YangShengzhou03/LeafAutoWeb?style=for-the-badge&logo=github" alt="GitHub Pull Requests">
  </a>
  <a href="#">
    <img src="https://img.shields.io/badge/Theme-%231e40af-blue?style=for-the-badge" alt="Theme Color: Klein Blue">
  </a>
  <a href="https://github.com/YangShengzhou03/LeafAutoWeb/commits/main">
    <img src="https://img.shields.io/github/last-commit/YangShengzhou03/LeafAutoWeb?style=for-the-badge&logo=github" alt="Last Commit">
  </a>
</div>

## ğŸ“‹ ç›®å½•

- [âœ¨ é¡¹ç›®ç‰¹è‰²](#-é¡¹ç›®ç‰¹è‰²)
- [ğŸš€ æ ¸å¿ƒåŠŸèƒ½](#-æ ¸å¿ƒåŠŸèƒ½)
- [ğŸ›  æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ)
- [ğŸ— ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„)
- [ğŸ“¦ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ğŸ”§ å®‰è£…æŒ‡å—](#-å®‰è£…æŒ‡å—)
- [ğŸ“ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [ğŸ”Œ API æ–‡æ¡£](#-api-æ–‡æ¡£)
- [ğŸ“„ è®¸å¯è¯](#-è®¸å¯è¯)

---

## âœ¨ é¡¹ç›®ç‰¹è‰²

**LeafAuto Web** æ˜¯ä¸€æ¬¾ä¸“ä¸šçš„å¾®ä¿¡æ¶ˆæ¯è‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸ºéœ€è¦é«˜æ•ˆç®¡ç†å¾®ä¿¡æ¶ˆæ¯å‘é€çš„ä¸ªäººå’Œä¼ä¸šç”¨æˆ·è®¾è®¡ã€‚

### ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜
- **ä¼ä¸šç”¨æˆ·**ï¼šå®šæœŸå‘å®¢æˆ·å‘é€é€šçŸ¥ã€æé†’æˆ–è¥é”€æ¶ˆæ¯çš„æ•ˆç‡é—®é¢˜
- **ä¸ªäººç”¨æˆ·**ï¼šè‡ªåŠ¨åŒ–ç”Ÿæ—¥æé†’ã€èŠ‚æ—¥é—®å€™ç­‰é‡å¤æ€§æ²Ÿé€š
- **å®¢æœäººå‘˜**ï¼šå¿«é€Ÿå“åº”å¸¸è§é—®é¢˜ï¼Œå‡è½»å·¥ä½œè´Ÿæ‹…

### ğŸ’ æ ¸å¿ƒä»·å€¼
- ğŸ“± **å¾®ä¿¡æ¶ˆæ¯è‡ªåŠ¨åŒ–**ï¼šå®šæ—¶å‘é€ä»»åŠ¡ï¼Œè§£æ”¾åŒæ‰‹ï¼Œæé«˜æ•ˆç‡
- ğŸ”„ **çµæ´»çš„é‡å¤è§„åˆ™**ï¼šæ”¯æŒå•æ¬¡ã€æ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆåŠè‡ªå®šä¹‰æ¨¡å¼
- ğŸ¤– **AI è‡ªåŠ¨å›å¤**ï¼šæ™ºèƒ½åº”å¯¹å„ç±»å’¨è¯¢ï¼Œæ”¯æŒå¤šç§å›å¤é£æ ¼
- ğŸ“Š **ä»»åŠ¡ç®¡ç†**ï¼šç›´è§‚æŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ é™¤è‡ªåŠ¨åŒ–ä»»åŠ¡
- ğŸ”’ **æ•°æ®å®‰å…¨**ï¼šæœ¬åœ°éƒ¨ç½²ï¼Œæ•°æ®å®Œå…¨æŒæ§
- ğŸ¨ **ç°ä»£ç•Œé¢**ï¼šé‡‡ç”¨å…‹è±å› è“ä¸»é¢˜è‰²ï¼Œç•Œé¢ç¾è§‚ä¸€è‡´
- âš¡ **ä¼˜åŒ–æ€§èƒ½**ï¼šæ¸…ç†å†—ä½™ä»£ç ï¼Œæå‡å“åº”é€Ÿåº¦
- ğŸ” **å®æ—¶ç›‘æ§**ï¼šå¾®ä¿¡çŠ¶æ€å®æ—¶ç›‘æ§ï¼Œè‡ªåŠ¨é‡è¿æœºåˆ¶
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°åŠŸèƒ½
- **å®šæ—¶æ¶ˆæ¯å‘é€**ï¼šæ”¯æŒå…·ä½“æ—¶é—´å’Œé‡å¤æ¨¡å¼è®¾ç½®
- **ä»»åŠ¡ç®¡ç†**ï¼šå®Œæ•´çš„å¢åˆ æ”¹æŸ¥åŠŸèƒ½ï¼ŒçŠ¶æ€è·Ÿè¸ª
- **æ•°æ®æŒä¹…åŒ–**ï¼šJSONæ–‡ä»¶å­˜å‚¨ä»»åŠ¡å’Œé…ç½®æ•°æ®
- **å‰ç«¯ç•Œé¢**ï¼šVue 3 + Element Plusç°ä»£åŒ–ç®¡ç†ç•Œé¢
- **RESTful API**ï¼šå®Œæ•´çš„åç«¯APIæ¥å£
- **å¾®ä¿¡è‡ªåŠ¨åŒ–**ï¼šåŸºäºwxautoxçš„æ¶ˆæ¯å‘é€
- **AIè‡ªåŠ¨å›å¤**ï¼šé…ç½®AIæ¥ç®¡æ¶ˆæ¯å›å¤
- **å¾®ä¿¡çŠ¶æ€ç›‘æ§**ï¼š30ç§’é—´éš”è‡ªåŠ¨æ£€æŸ¥å¾®ä¿¡è¿æ¥çŠ¶æ€
- **è‡ªåŠ¨é‡è¿æœºåˆ¶**ï¼šå¾®ä¿¡è¿æ¥ä¸¢å¤±æ—¶è‡ªåŠ¨å°è¯•é‡æ–°åˆå§‹åŒ–
- **çº¿ç¨‹å®‰å…¨**ï¼šæ•°æ®æ“ä½œçº¿ç¨‹å®‰å…¨ï¼Œé¿å…å¹¶å‘é—®é¢˜
- **è¯¦ç»†æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œé”™è¯¯è®°å½•

---

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **æ¡†æ¶**ï¼šFlask 2.2.3
- **æ•°æ®å­˜å‚¨**ï¼šJSONæ–‡ä»¶ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
- **ä»»åŠ¡è°ƒåº¦**ï¼šè‡ªå®šä¹‰å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
- **å¾®ä¿¡è‡ªåŠ¨åŒ–**ï¼šwxautox 3.9.11.17.25b47
- **CORSæ”¯æŒ**ï¼šflask-cors 4.0.0
- **å¹¶å‘æ§åˆ¶**ï¼šthreading.Lock ç¡®ä¿æ•°æ®å®‰å…¨
- **çŠ¶æ€ç›‘æ§**ï¼šåå°çº¿ç¨‹å®šæœŸæ£€æŸ¥ç³»ç»ŸçŠ¶æ€
- **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼å’Œæ—¥å¿—è®°å½•

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**ï¼šVue 3 + Composition API
- **UIæ¡†æ¶**ï¼šElement Plus 2.4.2
- **çŠ¶æ€ç®¡ç†**ï¼šPinia 2.1.7
- **è·¯ç”±**ï¼šVue Router 4.0.3
- **æ„å»ºå·¥å…·**ï¼šVue CLI 5

### å¼€å‘å·¥å…·
- **ä»£ç ç¼–è¾‘å™¨**ï¼šVS Code / PyCharm
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šGit
- **åŒ…ç®¡ç†**ï¼špip + npm

---

## ğŸ— ç³»ç»Ÿæ¶æ„

LeafAuto_Webé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š

```
å‰ç«¯ (Vue 3) â† HTTP API â†’ åç«¯ (Flask)
    â”‚                         â”‚
    â”‚                         â”œâ”€â”€ ä»»åŠ¡ç®¡ç†æ¨¡å— (data_manager.py)
    â”‚                         â”œâ”€â”€ å®šæ—¶è°ƒåº¦æ¨¡å— (task_scheduler.py)
    â”‚                         â”œâ”€â”€ å¾®ä¿¡å®ä¾‹æ¨¡å— (wechat_instance.py)
    â”‚                         â”œâ”€â”€ AIè¾…åŠ©æ¨¡å— (ai_worker.py)
    â”‚                         â””â”€â”€ æœåŠ¡å™¨ç®¡ç†æ¨¡å— (server_manager.py)
    â”‚
    â””â”€â”€ çŠ¶æ€ç®¡ç† (Pinia)
    â””â”€â”€ è·¯ç”±ç®¡ç† (Vue Router)
    â””â”€â”€ UIç»„ä»¶ (Element Plus)
```

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.7+
- Node.js 14+
- Windows/macOS/Linux

### ä¸€é”®å¯åŠ¨ï¼ˆWindowsï¼‰
```bash
# å¯åŠ¨å®Œæ•´åº”ç”¨ï¼ˆå‰åç«¯ï¼‰
test_app.bat

# æˆ–ä»…å¯åŠ¨å‰ç«¯æœåŠ¡
test_server.bat
```

è®¿é—®ï¼šhttp://localhost:8080

---

## ğŸ”§ å®‰è£…æŒ‡å—

### æ–¹æ³•ä¸€ï¼šæºç å®‰è£…ï¼ˆæ¨èï¼‰

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/YangShengzhou03/LeafAutoWeb.git
cd LeafAutoWeb
```

2. **å®‰è£…åç«¯ä¾èµ–**
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

3. **å®‰è£…å‰ç«¯ä¾èµ–**
```bash
npm install
```

4. **åˆå§‹åŒ–æ•°æ®æ–‡ä»¶**
```bash
# æ•°æ®æ–‡ä»¶ä¼šè‡ªåŠ¨åœ¨é¦–æ¬¡è¿è¡Œæ—¶åˆ›å»º
```

5. **è¿è¡Œæµ‹è¯•**
```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
pip install pytest pytest-cov

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=.
```

5. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
echo 'FLASK_APP=app.py' > .env
echo 'FLASK_ENV=development' >> .env
echo 'SECRET_KEY=your-secret-key-here' >> .env
```

### æ–¹æ³•äºŒï¼šDocker å®¹å™¨å®‰è£…

#### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/YangShengzhou03/LeafAutoWeb.git
cd LeafAutoWeb

# è®¾ç½®ç¯å¢ƒå˜é‡
echo "SECRET_KEY=your-secret-key" > .env

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# è®¿é—®åº”ç”¨
open http://localhost:8080
```

#### ä½¿ç”¨ Docker ç›´æ¥è¿è¡Œ
```bash
# æ„å»ºé•œåƒ
docker build -t leafauto-web .

# è¿è¡Œå®¹å™¨
docker run -d -p 8080:8080 \
  -v $(pwd)/data:/app/data \
  -e SECRET_KEY=your-secret-key \
  --name leafauto-web \
  leafauto-web
```

è¯¦ç»†éƒ¨ç½²è¯´æ˜è¯·å‚è€ƒ [DEPLOYMENT.md](./DEPLOYMENT.md)

### æ–¹æ³•ä¸‰ï¼šé¡¹ç›®å®Œæ•´æ€§éªŒè¯

è¿è¡ŒéªŒè¯è„šæœ¬æ£€æŸ¥æ‰€æœ‰åŠŸèƒ½ï¼š
```bash
python project_validation.py
```

---

## ğŸ“– ä½¿ç”¨æ•™ç¨‹

### å¯åŠ¨åº”ç”¨

1. **å¯åŠ¨åç«¯æœåŠ¡**
```bash
python app.py
```

2. **å¯åŠ¨å‰ç«¯æœåŠ¡**
```bash
npm run serve
```

3. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080

### åˆ›å»ºè‡ªåŠ¨åŒ–æ¶ˆæ¯ä»»åŠ¡

1. ç‚¹å‡»å·¦ä¾§èœå•ã€Œè‡ªåŠ¨ä¿¡æ¯ã€
2. å¡«å†™æ¥æ”¶è€…ä¿¡æ¯ï¼ˆå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰
3. é€‰æ‹©å‘é€æ—¶é—´
4. è®¾ç½®é‡å¤é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
5. è¾“å…¥æ¶ˆæ¯å†…å®¹
6. ç‚¹å‡»ã€Œåˆ›å»ºä»»åŠ¡ã€

### é…ç½® AI è‡ªåŠ¨å›å¤

1. ç‚¹å‡»å·¦ä¾§èœå•ã€ŒAI æ¥ç®¡ã€
2. å¼€å¯ã€ŒAI æ¥ç®¡çŠ¶æ€ã€
3. è®¾ç½®å›å¤å»¶è¿Ÿæ—¶é—´
4. é€‰æ‹©å›å¤é£æ ¼
5. è®¾ç½®æœ€å¤§å›å¤é•¿åº¦
6. é…ç½®å…³é”®è¯è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰
7. å¡«å†™å›å¤æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰
8. ç‚¹å‡»ã€Œä¿å­˜è®¾ç½®ã€

### æŸ¥çœ‹ä»»åŠ¡ç»Ÿè®¡

1. ç‚¹å‡»å·¦ä¾§èœå•ã€Œç»Ÿè®¡åˆ†æã€
2. æŸ¥çœ‹ä»»åŠ¡å®Œæˆç‡ã€æˆåŠŸç‡ç­‰æŒ‡æ ‡
3. æŸ¥çœ‹ AI å›å¤ç»Ÿè®¡æ•°æ®
4. å¯¼å‡ºç»Ÿè®¡æŠ¥å‘Šï¼ˆå¯é€‰ï¼‰

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
LeafAuto_Web/
â”œâ”€â”€ app.py                 # Flaskåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ data_manager.py        # æ•°æ®ç®¡ç†æ¨¡å—
â”œâ”€â”€ task_scheduler.py      # å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ wechat_instance.py     # å¾®ä¿¡å®ä¾‹ç®¡ç†
â”œâ”€â”€ ai_worker.py          # AIè‡ªåŠ¨å›å¤å·¥ä½œçº¿ç¨‹
â”œâ”€â”€ logging_config.py     # æ—¥å¿—é…ç½®æ¨¡å—
â”œâ”€â”€ server_manager.py     # æœåŠ¡å™¨ç®¡ç†
â”œâ”€â”€ start_app.py          # åº”ç”¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”œâ”€â”€ frontend/             # Vueå‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â”œâ”€â”€ main.js
â”‚   â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ views/
â”‚   â””â”€â”€ vue.config.js
â”œâ”€â”€ data/                 # æ•°æ®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ data.json         # ä»»åŠ¡æ•°æ®
â”‚   â”œâ”€â”€ ai_data.json      # AIè®¾ç½®æ•°æ®
â”‚   â”œâ”€â”€ home_data.json    # é¦–é¡µæ•°æ®
â”‚   â””â”€â”€ reply_history.json # å›å¤å†å²
â”œâ”€â”€ tests/                # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ logs/                 # æ—¥å¿—ç›®å½•
```

### é‡è¦æ–‡ä»¶è¯´æ˜

- **app.py**ï¼šFlaskåç«¯ä¸»åº”ç”¨ï¼Œæä¾›RESTful APIæ¥å£
- **data_manager.py**ï¼šæ ¸å¿ƒæ•°æ®ç®¡ç†æ¨¡å—ï¼Œå¤„ç†æ•°æ®æŒä¹…åŒ–æ“ä½œ
- **task_scheduler.py**ï¼šå®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨ï¼ŒåŒ…å«å¾®ä¿¡æ¶ˆæ¯å‘é€åŠŸèƒ½
- **project_validation.py**ï¼šé¡¹ç›®å®Œæ•´æ€§éªŒè¯è„šæœ¬
- **start_app.py**ï¼šä¸€é”®å¯åŠ¨è„šæœ¬
- **test_app.bat**ï¼šWindowsç¯å¢ƒå¯åŠ¨è„šæœ¬

---

## ğŸ”Œ API æ–‡æ¡£

## ğŸ¤– AI å·¥ä½œåŸç†è¯¦è§£

### AI æ•°æ®çœ‹æ¿ç”ŸæˆåŸç†

AI æ•°æ®çœ‹æ¿é€šè¿‡ <mcsymbol name="DataManager" filename="data_manager.py" path="d:\Code\Python\LeafAuto_Web\data_manager.py" startline="1" type="class"></mcsymbol> ç±»å®ç°ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹æ•°æ®æ”¶é›†å’Œå¤„ç†é€»è¾‘ï¼š

1. **æ•°æ®æ”¶é›†æœºåˆ¶**ï¼š
   - å®æ—¶è®°å½•æ‰€æœ‰ AI å›å¤æ“ä½œåˆ° <mcfile name="reply_history.json" path="d:\Code\Python\LeafAuto_Web\data\reply_history.json"></mcfile>
   - ç»Ÿè®¡å›å¤æˆåŠŸç‡ã€å“åº”æ—¶é—´ã€æ¶ˆæ¯ç±»å‹åˆ†å¸ƒç­‰å…³é”®æŒ‡æ ‡
   - é€šè¿‡å®šæ—¶ä»»åŠ¡å®šæœŸèšåˆæ•°æ®ç”Ÿæˆç»Ÿè®¡æŠ¥è¡¨

2. **çœ‹æ¿æ•°æ®ç”Ÿæˆæµç¨‹**ï¼š
   ```python
   # åœ¨ data_manager.py ä¸­çš„å®ç°é€»è¾‘
   def calculate_ai_statistics(self):
       """è®¡ç®—AIå›å¤ç»Ÿè®¡æ•°æ®"""
       history = self.load_reply_history()
       
       # è®¡ç®—å›å¤ç‡
       total_messages = len(history)
       replied_messages = len([h for h in history if h['status'] == 'replied'])
       reply_rate = (replied_messages / total_messages * 100) if total_messages > 0 else 0
       
       # è®¡ç®—å¹³å‡å“åº”æ—¶é—´
       response_times = [h.get('response_time', 0) for h in history if 'response_time' in h]
       avg_response_time = sum(response_times) / len(response_times) if response_times else 0
       
       return {
           'total_messages': total_messages,
           'replied_messages': replied_messages,
           'reply_rate': round(reply_rate, 2),
           'avg_response_time': round(avg_response_time, 2)
       }
   ```

3. **å®æ—¶æ›´æ–°æœºåˆ¶**ï¼š
   - å‰ç«¯é€šè¿‡å®šæ—¶è½®è¯¢è°ƒç”¨ `/api/ai-stats` API è·å–æœ€æ–°æ•°æ®
   - æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨è§¦å‘çœ‹æ¿åˆ·æ–°
   - æ”¯æŒå†å²æ•°æ®è¶‹åŠ¿åˆ†æ

### æ¶ˆæ¯å‘é€åŸç†

æ¶ˆæ¯å‘é€åŠŸèƒ½ç”± <mcsymbol name="TaskScheduler" filename="task_scheduler.py" path="d:\Code\Python\LeafAuto_Web\task_scheduler.py" startline="1" type="class"></mcsymbol> ç±»å®ç°ï¼š

1. **å‘é€å¼•æ“æ¶æ„**ï¼š
   - åŸºäº wxautox åº“å®ç°å¾®ä¿¡æ¶ˆæ¯å‘é€
   - ä½¿ç”¨ç‹¬ç«‹çš„å‘é€çº¿ç¨‹é¿å…é˜»å¡ä¸»çº¿ç¨‹
   - æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§å‘é€æ¨¡å¼

2. **å‘é€æµç¨‹**ï¼š
   ```python
   # åœ¨ task_scheduler.py ä¸­çš„æ ¸å¿ƒå‘é€é€»è¾‘
   def send_wechat_message(self, recipient, message):
       """å‘é€å¾®ä¿¡æ¶ˆæ¯"""
       try:
           # æ£€æŸ¥å¾®ä¿¡å®ä¾‹çŠ¶æ€
           if not self.wechat_instance or not self.wechat_instance.is_logged_in():
               self.logger.warning("å¾®ä¿¡å®ä¾‹æœªå°±ç»ªï¼Œå°è¯•é‡æ–°åˆå§‹åŒ–")
               self.initialize_wechat()
           
           # æ‰§è¡Œæ¶ˆæ¯å‘é€
           success = self.wechat_instance.send_message(recipient, message)
           
           if success:
               self.logger.info(f"æ¶ˆæ¯å‘é€æˆåŠŸ: {recipient} - {message[:50]}...")
               return True
           else:
               self.logger.error(f"æ¶ˆæ¯å‘é€å¤±è´¥: {recipient}")
               return False
               
       except Exception as e:
           self.logger.error(f"å‘é€æ¶ˆæ¯æ—¶å‘ç”Ÿå¼‚å¸¸: {str(e)}")
           return False
   ```

3. **é”™è¯¯å¤„ç†æœºåˆ¶**ï¼š
   - è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š3æ¬¡é‡è¯•ï¼‰
   - è¿æ¥çŠ¶æ€ç›‘æ§å’Œè‡ªåŠ¨æ¢å¤
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

### ç­‰å¾…å‘é€åŸç†

ç­‰å¾…å‘é€æœºåˆ¶ç¡®ä¿æ¶ˆæ¯åœ¨æ­£ç¡®çš„æ—¶é—´å‘é€ï¼š

1. **æ—¶é—´è°ƒåº¦ç®—æ³•**ï¼š
   - ä½¿ç”¨ Python çš„ `threading.Timer` å®ç°ç²¾ç¡®å®šæ—¶
   - æ”¯æŒå•æ¬¡ã€æ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆç­‰é‡å¤æ¨¡å¼
   - è‡ªåŠ¨å¤„ç†æ—¶åŒºè½¬æ¢å’Œå¤ä»¤æ—¶

2. **ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†**ï¼š
   ```python
   # åœ¨ task_scheduler.py ä¸­çš„ç­‰å¾…é€»è¾‘
   def schedule_task(self, task):
       """è°ƒåº¦ä»»åŠ¡åˆ°æŒ‡å®šæ—¶é—´æ‰§è¡Œ"""
       now = datetime.now()
       send_time = datetime.fromisoformat(task['sendTime'])
       
       # è®¡ç®—ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰
       wait_seconds = (send_time - now).total_seconds()
       
       if wait_seconds <= 0:
           # ç«‹å³æ‰§è¡Œè¿‡æœŸä»»åŠ¡
           self.execute_task(task)
       else:
           # åˆ›å»ºå®šæ—¶å™¨
           timer = threading.Timer(wait_seconds, self.execute_task, args=[task])
           timer.start()
           
           # å­˜å‚¨å®šæ—¶å™¨å¼•ç”¨ç”¨äºåç»­ç®¡ç†
           self.active_timers[task['id']] = timer
   ```

3. **å†…å­˜å’ŒæŒä¹…åŒ–ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨è½»é‡çº§æ•°æ®ç»“æ„å­˜å‚¨å®šæ—¶ä»»åŠ¡
   - æ”¯æŒåº”ç”¨é‡å¯åä»»åŠ¡æ¢å¤
   - é¿å…å†…å­˜æ³„æ¼çš„å®šæ—¶å™¨æ¸…ç†æœºåˆ¶

### AI æ¥ç®¡åŸç†

AI æ¥ç®¡åŠŸèƒ½é€šè¿‡ <mcsymbol name="AIWorker" filename="ai_worker.py" path="d:\Code\Python\LeafAuto_Web\ai_worker.py" startline="1" type="class"></mcsymbol> ç±»å®ç°ï¼š

1. **æ¶ˆæ¯ç›‘å¬å’Œå¤„ç†æµæ°´çº¿**ï¼š
   - å®æ—¶ç›‘æ§å¾®ä¿¡æ¶ˆæ¯æµå…¥
   - åŸºäºè§„åˆ™çš„æ¶ˆæ¯è¿‡æ»¤å’Œåˆ†ç±»
   - æ™ºèƒ½å›å¤ç­–ç•¥é€‰æ‹©

2. **AI å›å¤ç”Ÿæˆæµç¨‹**ï¼š
   ```python
   # åœ¨ ai_worker.py ä¸­çš„æ ¸å¿ƒå¤„ç†é€»è¾‘
   def process_incoming_message(self, sender, message):
       """å¤„ç† incoming æ¶ˆæ¯å¹¶ç”Ÿæˆå›å¤"""
       
       # 1. æ¶ˆæ¯é¢„å¤„ç†å’Œè¿‡æ»¤
       if not self.should_reply(sender, message):
           return None
       
       # 2. å›å¤å»¶è¿Ÿæ§åˆ¶
       time.sleep(self.reply_delay)
       
       # 3. AI å›å¤ç”Ÿæˆ
       reply_content = self.generate_ai_reply(message)
       
       # 4. å›å¤å‘é€å’Œæ‰§è¡Œ
       success = self.send_reply(sender, reply_content)
       
       # 5. è®°å½•å†å²
       self.record_reply_history(sender, message, reply_content, success)
       
       return success
   ```

3. **æ™ºèƒ½è¿‡æ»¤è§„åˆ™**ï¼š
   - å…³é”®è¯é»‘åå•/ç™½åå•è¿‡æ»¤
   - å‘é€é¢‘ç‡é™åˆ¶ï¼ˆé˜²éªšæ‰°ï¼‰
   - ç‰¹å®šè”ç³»äººä¸“å±å¤„ç†
   - @æ¶ˆæ¯ä¼˜å…ˆå¤„ç†æœºåˆ¶

4. **æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§**ï¼š
   - å¼‚æ­¥æ¶ˆæ¯å¤„ç†é¿å…é˜»å¡
   - å†…å­˜ç¼“å­˜é¢‘ç¹ä½¿ç”¨çš„å›å¤æ¨¡æ¿
   - è¿æ¥æ± ç®¡ç†ä¼˜åŒ–ç½‘ç»œè¯·æ±‚

## ğŸ”Œ API æ–‡æ¡£

### ä»»åŠ¡ç®¡ç† API

#### è·å–æ‰€æœ‰ä»»åŠ¡
```http
GET /api/tasks
```

#### æ·»åŠ æ–°ä»»åŠ¡
```http
POST /api/tasks
Content-Type: application/json

{
  "recipient": "å¥½å‹æ˜µç§°",
  "messageContent": "æ¶ˆæ¯å†…å®¹",
  "sendTime": "2023-12-01T10:00:00",
  "repeatType": "daily"
}
```

#### åˆ é™¤ä»»åŠ¡
```http
DELETE /api/tasks/{task_id}
```

#### æ›´æ–°ä»»åŠ¡çŠ¶æ€
```http
PATCH /api/tasks/{task_id}/status
Content-Type: application/json

{
  "status": "completed"
}
```

#### æ¸…ç©ºæ‰€æœ‰ä»»åŠ¡
```http
DELETE /api/tasks
```

#### å¯¼å…¥ä»»åŠ¡
```http
POST /api/tasks/import
Content-Type: application/json

[
  {
    "recipient": "å¥½å‹1",
    "messageContent": "æ¶ˆæ¯1",
    "sendTime": "2023-12-01T10:00:00"
  },
  {
    "recipient": "å¥½å‹2", 
    "messageContent": "æ¶ˆæ¯2",
    "sendTime": "2023-12-01T11:00:00"
  }
]
```

### AIè®¾ç½® API

#### è·å–AIè®¾ç½®
```http
GET /api/ai-settings
```

#### ä¿å­˜AIè®¾ç½®
```http
POST /api/ai-settings
Content-Type: application/json

{
  "aiStatus": true,
  "contactPerson": "è”ç³»äºº",
  "aiPersona": "ä½ å¾ˆæ¸©é¦¨,å›å¤ç®€å•æ˜äº†ã€‚",
  "onlyAt": false,
  "replyDelay": 5,
  "minReplyInterval": 60
}
```

#### è·å–AIå›å¤å†å²
```http
GET /api/ai-history
```

#### æ·»åŠ AIå›å¤å†å²
```http
POST /api/ai-history
Content-Type: application/json

{
  "sender": "å‘é€è€…",
  "message": "åŸå§‹æ¶ˆæ¯",
  "reply": "å›å¤å†…å®¹",
  "status": "replied"
}
```

### å¾®ä¿¡çŠ¶æ€ API

#### è·å–å¾®ä¿¡çŠ¶æ€
```http
GET /api/wechat-status
```

---

## ğŸ§ª é¡¹ç›®éªŒè¯

é¡¹ç›®åŒ…å«å®Œæ•´çš„éªŒè¯å’Œæµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šå¯é ï¼š

### éªŒè¯åŒ…ç»“æ„
é¡¹ç›®éªŒè¯åŠŸèƒ½å·²é‡æ„ä¸ºç‹¬ç«‹çš„ `validation` åŒ…ï¼Œæä¾›æ›´æ¸…æ™°çš„ç»„ç»‡ç»“æ„ï¼š

```bash
LeafAuto_Web/validation/
â”œâ”€â”€ __init__.py           # åŒ…åˆå§‹åŒ–ï¼Œå¯¼å‡ºæ‰€æœ‰éªŒè¯åŠŸèƒ½
â”œâ”€â”€ final_validation.py   # é¡¹ç›®éªŒè¯è„šæœ¬ï¼Œæ£€æŸ¥é¡¹ç›®ç»“æ„ã€PythonåŠŸèƒ½ã€å‰ç«¯åŠŸèƒ½å’Œç”¨æˆ·ä½“éªŒ
â”œâ”€â”€ scheduler_validation.py # è°ƒåº¦å™¨åŠŸèƒ½éªŒè¯ï¼Œæ¼”ç¤ºåŠ¨æ€é—´éš”è°ƒæ•´ã€é”™è¯¯æ¢å¤å’Œæ€§èƒ½ç›‘æ§
â”œâ”€â”€ robustness_testing.py # è°ƒåº¦å™¨é²æ£’æ€§æµ‹è¯•ï¼ŒéªŒè¯ç³»ç»Ÿåœ¨å¼‚å¸¸æƒ…å†µä¸‹çš„ç¨³å®šæ€§
â”œâ”€â”€ setup.py              # åŒ…å®‰è£…é…ç½®ï¼Œæ”¯æŒç‹¬ç«‹å®‰è£…éªŒè¯å·¥å…·
â””â”€â”€ README.md             # åŒ…è¯´æ˜æ–‡æ¡£
```

### ä½¿ç”¨æ–¹å¼
```python
# å¯¼å…¥éªŒè¯åŒ…
from validation import validate_project_structure, demonstrate_dynamic_interval

# è¿è¡Œé¡¹ç›®éªŒè¯
validate_project_structure()

# è¿è¡Œè°ƒåº¦å™¨éªŒè¯
demonstrate_dynamic_interval()
```

### æµ‹è¯•å¥—ä»¶
- **test_app.py**ï¼šåº”ç”¨å±‚æµ‹è¯•ï¼ŒéªŒè¯APIæ¥å£å’Œæ ¸å¿ƒåŠŸèƒ½
- **test_basic.py**ï¼šåŸºç¡€æµ‹è¯•ï¼ŒéªŒè¯æ•°æ®æ–‡ä»¶ã€JSONæœ‰æ•ˆæ€§å’Œä¾èµ–å®‰è£…
- **test_data_manager.py**ï¼šæ•°æ®ç®¡ç†æµ‹è¯•ï¼ŒéªŒè¯æ•°æ®åŠ è½½ã€ä¿å­˜å’Œå„ç±»æ“ä½œ

### è¿è¡ŒéªŒè¯
```bash
# è¿è¡Œæ‰€æœ‰éªŒè¯
python -c "from validation import main; main()"

# è¿è¡Œç‰¹å®šéªŒè¯
python -c "from validation import validate_project_structure; validate_project_structure()"

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest
```

---

## ğŸ“Š å¼€å‘çŠ¶æ€

### âœ… å·²å®ç°åŠŸèƒ½
- ä»»åŠ¡ç®¡ç†æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- AIè®¾ç½®åŸºç¡€åŠŸèƒ½
- æ•°æ®æŒä¹…åŒ–ï¼ˆJSONæ–‡ä»¶ï¼‰
- å‰ç«¯ç•Œé¢æ‰€æœ‰é¡µé¢ç»„ä»¶
- APIåŸºç¡€CRUDæ“ä½œ
- é¡¹ç›®å®Œæ•´æ€§éªŒè¯ç³»ç»Ÿ

### ğŸš§ å¼€å‘ä¸­åŠŸèƒ½
- ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ˆJWTï¼‰
- ä¼šå‘˜ç­‰çº§ç®¡ç†
- æ•°æ®ç»Ÿè®¡é¢æ¿
- å¾®ä¿¡å®é™…é›†æˆ
- æ•°æ®åº“æ”¯æŒ

### ğŸ“… è§„åˆ’åŠŸèƒ½
- æ¶ˆæ¯æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ
- å¤šè¯­è¨€æ”¯æŒ
- é«˜çº§ç»Ÿè®¡åˆ†æ
- ç§»åŠ¨ç«¯é€‚é…
- ç¬¬ä¸‰æ–¹é›†æˆ

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. **Fork é¡¹ç›®**
2. **åˆ›å»ºç‰¹æ€§åˆ†æ”¯**ï¼š`git checkout -b feature/AmazingFeature`
3. **æäº¤æ›´æ”¹**ï¼š`git commit -m 'Add some AmazingFeature'`
4. **æ¨é€åˆ°åˆ†æ”¯**ï¼š`git push origin feature/AmazingFeature`
5. **æäº¤ Pull Request**

### å¼€å‘è§„èŒƒ
- éµå¾ªPEP 8 Pythonä»£ç è§„èŒƒ
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ç¡®ä¿ä»£ç é€šè¿‡æ‰€æœ‰æµ‹è¯•

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **AGPL-3.0** è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä½œè€…**ï¼šYangShengzhou03
- **GitHub**ï¼š[https://github.com/YangShengzhou03/LeafAutoWeb](https://github.com/YangShengzhou03/LeafAutoWeb)
- **é—®é¢˜åé¦ˆ**ï¼š[åˆ›å»ºIssue](https://github.com/YangShengzhou03/LeafAutoWeb/issues)
- **åŠŸèƒ½è¯·æ±‚**ï¼š[æäº¤Feature Request](https://github.com/YangShengzhou03/LeafAutoWeb/issues/new?template=feature_request.md)

---

## â­ æ”¯æŒé¡¹ç›®

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼æ‚¨çš„æ”¯æŒæ˜¯æˆ‘ä»¬æŒç»­æ”¹è¿›çš„åŠ¨åŠ›ï¼

â­ **Star å¢é•¿è¶‹åŠ¿** - è§è¯é¡¹ç›®çš„æˆé•¿å†ç¨‹ï¼š
[![Star History Chart](https://api.star-history.com/svg?repos=YangShengzhou03/LeafAutoWeb&type=Date)](https://star-history.com/#YangShengzhou03/LeafAutoWeb&Date)

ğŸ’ **å¦‚ä½•æ”¯æŒé¡¹ç›®**ï¼š
- â­ ç»™é¡¹ç›®ä¸€ä¸ª Star
- ğŸ› æäº¤ Issue æŠ¥å‘Šé—®é¢˜
- ğŸ’¡ æå‡ºåŠŸèƒ½å»ºè®®
- ğŸ”§ è´¡çŒ®ä»£ç æ”¹è¿›
- ğŸ“¢ åˆ†äº«ç»™æ›´å¤šå¼€å‘è€…

æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ‰“é€ æ›´å¥½çš„å¾®ä¿¡è‡ªåŠ¨åŒ–å·¥å…·ï¼ğŸš€